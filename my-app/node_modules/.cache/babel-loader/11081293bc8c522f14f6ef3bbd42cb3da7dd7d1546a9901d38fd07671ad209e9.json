{"ast":null,"code":"import \"core-js/modules/web.dom-exception.stack.js\";\nimport { createRouter, createWebHistory } from 'vue-router';\nimport LoginPage from '../components/LoginPage.vue';\nimport AdminPage from '../components/AdminPage.vue';\nimport StudentPage from '../components/StudentPage.vue';\nimport TeacherPage from '../components/TeacherPage.vue';\nimport StudentsPage from '../components/StudentsPage.vue';\nimport TeachersPage from '../components/TeachersPage.vue';\nimport UserDetails from '../components/UserDetails.vue';\nimport ProjectTable from '../components/ProjectTable.vue';\nconst routes = [{\n  path: '/',\n  name: 'Login',\n  component: LoginPage\n}, {\n  path: '/Login',\n  name: 'Login',\n  component: LoginPage\n}, {\n  path: '/Admin',\n  name: 'Admin',\n  component: AdminPage,\n  meta: {\n    requiresAuth: true,\n    role: 'admin'\n  }\n}, {\n  path: '/Student',\n  name: 'Student',\n  component: StudentPage,\n  meta: {\n    requiresAuth: true,\n    role: 'student'\n  }\n}, {\n  path: '/admin/Students',\n  name: 'Students',\n  component: StudentsPage,\n  meta: {\n    requiresAuth: true,\n    role: 'admin'\n  }\n}, {\n  path: '/admin/Teachers',\n  name: 'Teachers',\n  component: TeachersPage,\n  meta: {\n    requiresAuth: true,\n    role: 'admin'\n  }\n}, {\n  path: '/teacher/projects',\n  name: 'TeacherProjects',\n  component: TeacherPage,\n  meta: {\n    requiresAuth: true,\n    role: 'teacher'\n  }\n}, {\n  path: '/user-details/:userId',\n  name: 'UserDetails',\n  component: UserDetails,\n  meta: {\n    requiresAuth: true,\n    roles: ['admin', 'teacher']\n  }\n}, {\n  path: '/teacher/projects/:projectId',\n  name: 'ProjectTable',\n  component: ProjectTable,\n  props: true\n}];\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n});\nrouter.beforeEach((to, from, next) => {\n  const token = localStorage.getItem('token');\n  const requiresAuth = to.matched.some(record => record.meta.requiresAuth);\n  if (requiresAuth && !token) {\n    next('/Login'); // Redirect to login page if authentication is required but token is not present\n  } else {\n    const userRole = token ? parseToken(token).role : null;\n    if (requiresAuth && !hasPermission(userRole, to.meta.roles)) {\n      // Redirect to corresponding role page if user role does not match the route's required role\n      switch (userRole) {\n        case 'admin':\n          next('/Admin');\n          break;\n        case 'student':\n          next('/Student');\n          break;\n        case 'teacher':\n          next('/Teacher');\n          break;\n        default:\n          next('/Login');\n        // Redirect to login page if user role is invalid\n      }\n    } else {\n      next(); // Allow access to the route\n    }\n  }\n});\nfunction parseToken(token) {\n  const [, payloadBase64] = token.split('.');\n  const payloadJson = atob(payloadBase64);\n  const payload = JSON.parse(payloadJson);\n  return payload;\n}\nfunction hasPermission(userRole, allowedRoles) {\n  // Check if the user's role is included in the allowed roles array\n  return userRole && allowedRoles.includes(userRole);\n}\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","LoginPage","AdminPage","StudentPage","TeacherPage","StudentsPage","TeachersPage","UserDetails","ProjectTable","routes","path","name","component","meta","requiresAuth","role","roles","props","router","history","process","env","BASE_URL","beforeEach","to","from","next","token","localStorage","getItem","matched","some","record","userRole","parseToken","hasPermission","payloadBase64","split","payloadJson","atob","payload","JSON","parse","allowedRoles","includes"],"sources":["/Users/angel/school-project/my-app/src/router/index.js"],"sourcesContent":["import { createRouter, createWebHistory } from 'vue-router'\nimport LoginPage from '../components/LoginPage.vue'\nimport AdminPage from '../components/AdminPage.vue'\nimport StudentPage from '../components/StudentPage.vue'\nimport TeacherPage from '../components/TeacherPage.vue'\nimport StudentsPage from '../components/StudentsPage.vue'\nimport TeachersPage from '../components/TeachersPage.vue'\nimport UserDetails from '../components/UserDetails.vue'\nimport ProjectTable from '../components/ProjectTable.vue'\n\nconst routes = [\n  {\n    path: '/',\n    name: 'Login',\n    component: LoginPage\n  },\n  {\n    path: '/Login',\n    name: 'Login',\n    component: LoginPage\n  },\n  {\n    path: '/Admin',\n    name: 'Admin',\n    component: AdminPage,\n    meta: { requiresAuth: true, role: 'admin' }\n  },\n  {\n    path: '/Student',\n    name: 'Student',\n    component: StudentPage,\n    meta: { requiresAuth: true, role: 'student' }\n  },\n  {\n    path: '/admin/Students',\n    name: 'Students',\n    component: StudentsPage,\n    meta: { requiresAuth: true, role: 'admin' }\n  },\n  {\n    path: '/admin/Teachers',\n    name: 'Teachers',\n    component: TeachersPage,\n    meta: { requiresAuth: true, role: 'admin' }\n  },\n  {\n    path: '/teacher/projects',\n    name: 'TeacherProjects',\n    component: TeacherPage,\n    meta: { requiresAuth: true, role: 'teacher' }\n  },\n  {\n    path: '/user-details/:userId',\n    name: 'UserDetails',\n    component: UserDetails,\n    meta: { requiresAuth: true, roles: ['admin', 'teacher'] }\n  },\n  {\n    path: '/teacher/projects/:projectId',\n    name: 'ProjectTable',\n    component: ProjectTable,\n    props: true\n  }\n]\n\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n})\n\nrouter.beforeEach((to, from, next) => {\n  const token = localStorage.getItem('token')\n  const requiresAuth = to.matched.some((record) => record.meta.requiresAuth)\n\n  if (requiresAuth && !token) {\n    next('/Login') // Redirect to login page if authentication is required but token is not present\n  } else {\n    const userRole = token ? parseToken(token).role : null\n\n    if (requiresAuth && !hasPermission(userRole, to.meta.roles)) {\n      // Redirect to corresponding role page if user role does not match the route's required role\n      switch (userRole) {\n        case 'admin':\n          next('/Admin')\n          break\n        case 'student':\n          next('/Student')\n          break\n        case 'teacher':\n          next('/Teacher')\n          break\n        default:\n          next('/Login') // Redirect to login page if user role is invalid\n      }\n    } else {\n      next() // Allow access to the route\n    }\n  }\n})\n\nfunction parseToken(token) {\n  const [, payloadBase64] = token.split('.')\n  const payloadJson = atob(payloadBase64)\n  const payload = JSON.parse(payloadJson)\n  return payload\n}\n\nfunction hasPermission(userRole, allowedRoles) {\n  // Check if the user's role is included in the allowed roles array\n  return userRole && allowedRoles.includes(userRole)\n}\n\nexport default router\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}